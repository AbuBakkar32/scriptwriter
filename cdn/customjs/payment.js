(()=>{var s="pk_test_51KbXSeJXVkce513AtFUhOo12t30jY1ZoFYj6HrUPdiAMlHCRYyUZElLuZ2ndTHb9iI7vqCHiBksfkQs7L3ipPZ1Q006EbQ9QkM",i=class{switchCheckBox;payBtn;amountWrap;planWrap;unit;crsfToken;constructor(){this.unit=1;let t="sw-payment";this.switchCheckBox=document.querySelector(`[${t}="switch"]`),this.payBtn=document.querySelector(`[${t}="btn"]`),this.amountWrap=document.querySelector(`[${t}="amount"]`),this.planWrap=document.querySelector(`[${t}="plan"]`),this.crsfToken=document.querySelector('input[name="csrfmiddlewaretoken"]'),this.listener()}listener(){!this.switchCheckBox||(this.switchCheckBox?.addEventListener("change",()=>{this.switchCheckBox?.checked?(this.unit=2,this.planWrap&&(this.planWrap.textContent="Year"),this.amountWrap&&(this.amountWrap.textContent="180")):(this.unit=1,this.planWrap&&(this.planWrap.textContent="Month"),this.amountWrap&&(this.amountWrap.textContent="15"))}),this.payBtn?.addEventListener("click",()=>{this.payBtn&&(this.payBtn.disabled=!0,this.makePayment())}))}async makePayment(){let t=this.crsfToken?.value,n=new FormData,a=window.Stripe(s);n.append("unit",String(this.unit)),n.append("csrfmiddlewaretoken",String(t)),await fetch(location.origin+"/payment-initiate",{method:"POST",body:n}).then(e=>e.json()).then(e=>{if(e.result==="success")return a.redirectToCheckout({sessionId:e.id});alert("payment initialization failed"),this.payBtn&&(this.payBtn.disabled=!1)}).catch(e=>{console.log("Error:",e),this.payBtn&&(this.payBtn.disabled=!1)})}};document.addEventListener("DOMContentLoaded",()=>{new i});})();
